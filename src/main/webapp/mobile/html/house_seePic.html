<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
<title>中介宝</title>
<meta name="description" content="">
<meta name="keywords" content="">
<link href="../css/reset.css" rel="stylesheet">
<link href="../css/style.css" rel="stylesheet">
<link href="../js/owl/owl.carousel.css" rel="stylesheet">
<script src="../js/jquery.min.js" type="text/javascript"></script>
<script src="../js/common.js" type="text/javascript"></script>
<script src="../js/buildHtml.js" type="text/javascript"></script>
<script src="../js/owl/owl.carousel.min.js" type="text/javascript"></script>
<script type="text/javascript">
apiready=function(){
	//blockAlert(JSON.stringify(api.pageParam.imgArr));
	buildHtmlWithJsonArray('repeat', api.pageParam.imgArr , true,true);
	//blockAlert($('.owl-info').length);
	$("#houseMaxPic").owlCarousel({
	    lazyLoad : true,
	    navigation:false,
	    singleItem : true,
	    autoHeight : true,
	    addClassActive:true,
	    afterInit:function(e){
	       addToolAction(e);
	    },
	    afterMove:function(e){
	       addToolAction(e);
	    }
	})
}

$(function(){
 //    buildHtmlWithJsonArray('repeat', [{path:'http://www.zhongjiebao.com/zjb_house_images/428198/2577/p-5885cf8c.jpg.t.jpg'},{path:'http://www.zhongjiebao.com/zjb_house_images/428198/2577/p-5885cf8c.jpg.t.jpg'}] , true,true);
	// $("#houseMaxPic").owlCarousel({
	//     //lazyLoad : true,
	//     navigation:false,
	//     singleItem : true,
	//     autoHeight : true,
	//     addClassActive:true,
	//     afterInit:function(e){
	//        addToolAction(e);
	//     },
	//     afterMove:function(e){
	//        addToolAction(e);
	//     }
	// })
});

function addToolAction(e){
    var t=$('.tool'),
    e=e,
    tb=e.find('.active .owl-info'),
    hiid=tb.data('hiid'),
    zan=tb.data('zan'),
    zanCount=tb.data('zancount'),
    shit=tb.data('shit'),
    shitCount=tb.data('shitcount');
    zanCount=!zanCount||zanCount<0?0:zanCount;
    shitCount=!shitCount||shitCount<0?0:shitCount;
    if(hiid>0){
        t.data('hiid',hiid);
        t.find('a.zan b').text(zanCount);
        t.find('a.shit b').text(shitCount);
        if(zan==1){
            t.addClass('ok');
            t.find('a.zan').addClass('this');
        }else if(shit==1){
            t.addClass('ok');
            t.find('a.shit').addClass('this');
        }else{
            t.removeClass('ok');
            t.find('a').removeClass('this');
        }
    }

}
$(document).on('click', 'a.zan,a.shit', function(event) {
    var Thi=$(this),
    ThiP=Thi.parent(),
    TPisok=ThiP.hasClass('ok'),
    TPhiid=ThiP.data('hiid');
    if(!TPisok){
        if(1){
            //layer.msg('成功:'+TPhiid);
            Thi.addClass('this');
            ThiP.addClass('ok');
        }else{layer.msg('失败');}
    }return false;
    event.preventDefault();
    /* Act on the event */
});
</script>
<style type="text/css">
</style>
</head>
<body>
<div id="wrap" class="bodyer house seepic">
    <div id="header" class="header">
        <span class="left">
            <a href="#" class="btns"><i class="iconfont">&#xe628;</i></a>
        </span>
        <span class="right">
            <!-- <a href="#" class="btns" id="s"><i class="iconfont">&#xe615;</i></a>
            <a href="#" class="btns" id="s"><i class="iconfont">&#xe616;</i></a> -->
        </span>
    </div>
    <div id="mainer" class="mainer">
        <div class="item">
<div id="houseMaxPic" class="owl-carousel">
  <div class="owl-info repeat" data-hiid="1" data-zan="$[zan]" data-zanCount="$[zanCount]" data-shit="$[shit]" data-shitCount="$[shitCount]"><img class="lazyOwl" data-src="$[path]"></div>
</div>
<div class="tool" data-hiid="">
    <a href="#" class="btns zan"><i class="iconfont">&#xe615;</i><b>0</b></a>
    <a href="#" class="btns shit"><i class="iconfont">&#xe616;</i><b>0</b></a>
</div>
<div class="loadings"><div class="loader"></div></div>
        </div>
    </div>
</div>
</body>
</html>